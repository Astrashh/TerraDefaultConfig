id: DEFAULT
author: dfsek
version: 2.0.0

structures:
  locatable:
    minecraft:desert_pyramid: DESERT
    minecraft:stronghold: STRONGHOLD
    minecraft:pillager_outpost: OUTPOST
    minecraft:swamp_hut: SWAMP
    minecraft:monument: MONUMENT
    minecraft:igloo: IGLOO
    minecraft:jungle_pyramid: JUNGLE
    minecraft:ruined_portal: RUINED_PORTAL
    minecraft:village: VILLAGE
    minecraft:mineshaft: MINESHAFT

blend:
  terrain:
    step: 3
    elevation: 4

vanilla:
  mobs: true

noise:
  noise2:
    dimensions: 2
    type: OpenSimplex2
    frequency: 0.0075
    fractal:
      type: FBm
      octaves: 4
    noise:
      type: WhiteNoise
  noise3:
    dimensions: 3
    type: OpenSimplex2
    frequency: 0.0075
    fractal:
      type: FBm
      octaves: 4
  noiseC:
    dimensions: 2
    type: Cellular
    frequency: 0.25
    cellular:
      return: NoiseLookup
      lookup:
        dimensions: 2
        type: OpenSimplex2
        frequency: 0.02
        fractal:
          type: FBm
          octaves: 4
locatable:
  STRONGHOLD: STRONGHOLD
variables:
  base: 63
biomes:
  type: PIPELINE
  resolution: 1
  blend:
    amplitude: 0
    noise:
      type: Constant
  image:
    name: map.jpg
  pipeline:
    source:
      type: NOISE
      biomes:
        OCEAN: 1
        PLAINS: 2
      noise:
        type: OpenSimplex2
        frequency: 0.05
    stages:
      - mutate: # Ocean climate distribution
          type: REPLACE
          from: "BIOME:OCEAN"
          to:
            - "COLD_OCEAN_DEEP": 3
            - "OCEAN_DEEP": 4
            - "WARM_OCEAN_DEEP": 9
          noise:
            type: OpenSimplex2 # Use Simplex, so hot cannot be directly next to cold.
            salt: 2 # Salt with 2 so ocean & land have same climates.
            frequency: 0.025
      - mutate: # Land climate distribution
          type: REPLACE
          from: "BIOME:PLAINS"
          to:
            - TUNDRA: 3
            - PLAINS: 4
            - JUNGLE: 9
          noise:
            type: OpenSimplex2 # Use Simplex, so hot cannot be directly next to cold.
            salt: 2 # Salt with 2 so ocean & land have same climates.
            frequency: 0.025
      - mutate:
          type: REPLACE
          from: "BIOME:WARM_OCEAN_DEEP"
          to:
            - "WARM_OCEAN_DEEP": 1
            - "LUKEWARM_OCEAN_DEEP": 4
          noise:
            type: WhiteNoise
            salt: 21
      - mutate: # Randomize Cold/Frozen oceans.
          type: REPLACE
          from: "BIOME:COLD_OCEAN_DEEP"
          to:
            - "COLD_OCEAN_DEEP": 4
            - "FROZEN_OCEAN_DEEP": 1
          noise:
            type: WhiteNoise
            salt: 21
      - mutate: # Humidity distribution of warm biomes
          type: REPLACE
          from: "BIOME:JUNGLE"
          to:
            - JUNGLE: 2
            - SAVANNA: 1
            - DESERT: 2
          noise:
            type: OpenSimplex2 # Use Simplex, so wet cannot be directly next to dry.
            salt: 5
            frequency: 0.0325
      - mutate: # Neutral warm biomes.
          type: REPLACE
          from: "BIOME:SAVANNA"
          to:
            - FOREST: 2
            - PLAINS: 3
          noise:
            type: Cellular # Use cellular to increase biome size.
            cellular:
              return: CellValue
            frequency: 0.25
            salt: 6
      - mutate: # Dry warm biomes
          type: REPLACE
          from: "BIOME:DESERT"
          to:
            - MESA: 1
            - DESERT: 3
            - SAVANNA: 2
            - ARID_MOUNTAINS: 1
          noise:
            type: Cellular # Use cellular to increase biome size.
            cellular:
              return: CellValue
            frequency: 0.25
            salt: 7
      - mutate: # Wet warm biomes
          type: REPLACE
          from: "BIOME:JUNGLE"
          to:
            - JUNGLE: 2
            - MOUNTAINS_JUNGLE: 1
            - ROCKY_TALL_FOREST: 1
            - SWAMP: 1
          noise:
            type: Cellular # Use cellular to increase biome size.
            cellular:
              return: CellValue
            frequency: 0.25
            salt: 8
      - mutate: # Distribution of neutral temperature biomes.
          type: REPLACE
          from: "BIOME:PLAINS"
          to:
            - FOREST: 3
            - BIRCH_FOREST: 1
            - PLAINS: 3
            - DARK_FOREST: 1
            - CRAG: 1
            - MOUNTAINS_PRETTY: 1
          noise:
            type: Cellular # Use cellular to increase biome size.
            cellular:
              return: CellValue
            frequency: 0.25
            salt: 9
      - mutate: # Distribution of cold biomes.
          type: REPLACE
          from: "BIOME:TUNDRA"
          to:
            - TAIGA: 2
            - SNOWY_TAIGA: 1
            - MOUNTAINS_STONE: 1
            - TUNDRA: 1
          noise:
            type: Cellular # Use cellular to increase biome size.
            cellular:
              return: CellValue
            frequency: 0.25
            salt: 10
      - expand:
          type: FRACTAL
          noise:
            type: WhiteNoise
            salt: 11
      - mutate: # Border deep ocean with normal ocean.
          type: BORDER_LIST
          from: LAND
          replace:
            WARM_OCEAN_DEEP: WARM_OCEAN
            LUKEWARM_OCEAN_DEEP: LUKEWARM_OCEAN
            COLD_OCEAN_DEEP: COLD_OCEAN
            FROZEN_OCEAN_DEEP: FROZEN_OCEAN
  
          default-replace: OCEAN_DEEP
          default-to: OCEAN
          noise:
            type: Constant
      - expand:
          type: FRACTAL
          noise:
            type: WhiteNoise
            salt: 11
      - mutate: # Mushroom Islands
          type: REPLACE
          from: "BIOME:OCEAN_DEEP"
          to:
            - "MUSHROOM": 1
            - "SELF": 9
          noise:
            type: OpenSimplex2 # Simplex islands
            salt: 24
            frequency: 0.1
      - expand:
          type: FRACTAL
          noise:
            type: WhiteNoise
            salt: 12
      - expand:
          type: FRACTAL
          noise:
            type: WhiteNoise
            salt: 13
      - mutate: # Generate beaches at land/ocean border.
          type: BORDER
          from: OCEAN
          replace: LAND
          to:
            - BEACH: 1
          noise:
            type: Constant
      - expand:
          type: FRACTAL
          noise:
            type: WhiteNoise
            salt: 14
      - mutate: # Mushroom beaches.
          type: BORDER
          from: OCEAN
          replace: LAND_MUSHROOM
          to:
            - MUSHROOM_BEACH: 1
          noise:
            type: Constant
      - mutate: # Regular ocean around mushroom biomes, to prevent steep drop-off.
          type: BORDER
          from: BIOME:MUSHROOM_BEACH
          replace: OCEAN_DEEP
          to:
            - OCEAN: 1
          noise:
            type: Constant
      - mutate:
          type: SMOOTH
          noise:
            type: WhiteNoise
            salt: 18
      - expand:
          type: FRACTAL
          noise:
            type: WhiteNoise
            salt: 16
      - mutate: # Erode rivers.
          type: REPLACE_LIST
          to:
            MOUNTAINS_JUNGLE:
              - SELF: 5
              - RIVER_M_J: 1
              - SELF: 5
            MOUNTAINS_STONE:
              - SELF: 5
              - RIVER_M: 1
              - SELF: 5
            MOUNTAINS_PRETTY:
              - SELF: 5
              - RIVER_M_P: 1
              - SELF: 5
          default-from: "RIVER_ERODE"
          default-to:
            - SELF: 5
            - RIVER: 1
            - SELF: 5
          noise:
            type: OpenSimplex2
            frequency: 0.003
            fractal:
              octaves: 2
              type: FBm
              gain: 0.2
              lacunarity: 4
      - mutate:
          type: SMOOTH
          noise:
            type: WhiteNoise
            salt: 18
      - mutate:
          type: SMOOTH
          noise:
            type: WhiteNoise
            salt: 19
